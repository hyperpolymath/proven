// Generated by ReScript, PLEASE EDIT WITH CARE


var CommonScopes = {
  openid: "openid",
  profile: "profile",
  email: "email",
  address: "address",
  phone: "phone",
  offlineAccess: "offline_access"
};

function tokenTypeFromString(s) {
  var lower = s.toLowerCase();
  switch (lower) {
    case "bearer" :
        return "Bearer";
    case "dpop" :
        return "DPoP";
    case "mac" :
        return "Mac";
    default:
      return ;
  }
}

function tokenTypeToString(tt) {
  switch (tt) {
    case "Bearer" :
        return "Bearer";
    case "Mac" :
        return "MAC";
    case "DPoP" :
        return "DPoP";
    
  }
}

function grantTypeFromString(s) {
  switch (s) {
    case "authorization_code" :
        return "AuthorizationCode";
    case "client_credentials" :
        return "ClientCredentials";
    case "password" :
        return "Password";
    case "refresh_token" :
        return "RefreshToken";
    case "urn:ietf:params:oauth:grant-type:device_code" :
        return "DeviceCode";
    case "urn:ietf:params:oauth:grant-type:jwt-bearer" :
        return "JwtBearer";
    default:
      return ;
  }
}

function grantTypeToString(gt) {
  switch (gt) {
    case "AuthorizationCode" :
        return "authorization_code";
    case "ClientCredentials" :
        return "client_credentials";
    case "RefreshToken" :
        return "refresh_token";
    case "Password" :
        return "password";
    case "DeviceCode" :
        return "urn:ietf:params:oauth:grant-type:device_code";
    case "JwtBearer" :
        return "urn:ietf:params:oauth:grant-type:jwt-bearer";
    
  }
}

function codeChallengeMethodFromString(s) {
  switch (s) {
    case "S256" :
        return "S256";
    case "plain" :
        return "Plain";
    default:
      return ;
  }
}

function codeChallengeMethodToString(ccm) {
  if (ccm === "Plain") {
    return "plain";
  } else {
    return "S256";
  }
}

function errorCodeFromString(s) {
  switch (s) {
    case "access_denied" :
        return "AccessDenied";
    case "invalid_client" :
        return "InvalidClient";
    case "invalid_grant" :
        return "InvalidGrant";
    case "invalid_request" :
        return "InvalidRequest";
    case "invalid_scope" :
        return "InvalidScopeError";
    case "server_error" :
        return "ServerError";
    case "temporarily_unavailable" :
        return "TemporarilyUnavailable";
    case "unauthorized_client" :
        return "UnauthorizedClient";
    case "unsupported_grant_type" :
        return "UnsupportedGrantTypeError";
    case "unsupported_response_type" :
        return "UnsupportedResponseType";
    default:
      return ;
  }
}

function errorCodeToString(ec) {
  switch (ec) {
    case "InvalidRequest" :
        return "invalid_request";
    case "InvalidClient" :
        return "invalid_client";
    case "InvalidGrant" :
        return "invalid_grant";
    case "UnauthorizedClient" :
        return "unauthorized_client";
    case "UnsupportedGrantTypeError" :
        return "unsupported_grant_type";
    case "InvalidScopeError" :
        return "invalid_scope";
    case "AccessDenied" :
        return "access_denied";
    case "UnsupportedResponseType" :
        return "unsupported_response_type";
    case "ServerError" :
        return "server_error";
    case "TemporarilyUnavailable" :
        return "temporarily_unavailable";
    
  }
}

function isValidTokenChar(charCode) {
  if (charCode >= 33.0) {
    return charCode <= 126.0;
  } else {
    return false;
  }
}

function isNqchar(charCode) {
  if (charCode === 33.0 || charCode >= 35.0 && charCode <= 91.0) {
    return true;
  } else if (charCode >= 93.0) {
    return charCode <= 126.0;
  } else {
    return false;
  }
}

function isPkceUnreservedChar(charCode) {
  if (charCode >= 65.0 && charCode <= 90.0 || charCode >= 97.0 && charCode <= 122.0 || charCode >= 48.0 && charCode <= 57.0 || charCode === 45.0 || charCode === 46.0 || charCode === 95.0) {
    return true;
  } else {
    return charCode === 126.0;
  }
}

function isBase64UrlChar(charCode) {
  if (charCode >= 65.0 && charCode <= 90.0 || charCode >= 97.0 && charCode <= 122.0 || charCode >= 48.0 && charCode <= 57.0 || charCode === 45.0 || charCode === 95.0) {
    return true;
  } else {
    return charCode === 61.0;
  }
}

function validateAccessToken(token) {
  var len = token.length;
  if (len === 0 || len > 4096) {
    return {
            TAG: "Error",
            _0: "InvalidToken"
          };
  }
  var chars = token.split("");
  var allValid = chars.every(function (c) {
        var code = c.charCodeAt(0);
        return isValidTokenChar(code);
      });
  if (allValid) {
    return {
            TAG: "Ok",
            _0: undefined
          };
  } else {
    return {
            TAG: "Error",
            _0: "InvalidToken"
          };
  }
}

function validateRefreshToken(token) {
  var len = token.length;
  if (len === 0 || len > 4096) {
    return {
            TAG: "Error",
            _0: "InvalidRefreshToken"
          };
  }
  var chars = token.split("");
  var allValid = chars.every(function (c) {
        var code = c.charCodeAt(0);
        return isValidTokenChar(code);
      });
  if (allValid) {
    return {
            TAG: "Ok",
            _0: undefined
          };
  } else {
    return {
            TAG: "Error",
            _0: "InvalidRefreshToken"
          };
  }
}

function validateAuthorizationCode(code) {
  var len = code.length;
  if (len === 0 || len > 4096) {
    return {
            TAG: "Error",
            _0: "InvalidAuthorizationCode"
          };
  }
  var chars = code.split("");
  var allValid = chars.every(function (c) {
        var code = c.charCodeAt(0);
        return isValidTokenChar(code);
      });
  if (allValid) {
    return {
            TAG: "Ok",
            _0: undefined
          };
  } else {
    return {
            TAG: "Error",
            _0: "InvalidAuthorizationCode"
          };
  }
}

function validateScopeName(scope) {
  var len = scope.length;
  if (len === 0 || len > 256) {
    return {
            TAG: "Error",
            _0: "InvalidScope"
          };
  }
  var chars = scope.split("");
  var allValid = chars.every(function (c) {
        var code = c.charCodeAt(0);
        return isNqchar(code);
      });
  if (allValid) {
    return {
            TAG: "Ok",
            _0: undefined
          };
  } else {
    return {
            TAG: "Error",
            _0: "InvalidScope"
          };
  }
}

function validateScopeString(scopeString) {
  var len = scopeString.length;
  if (len > 1024) {
    return {
            TAG: "Error",
            _0: "InvalidScope"
          };
  }
  if (len === 0) {
    return {
            TAG: "Ok",
            _0: undefined
          };
  }
  var scopes = scopeString.split(" ");
  var hasEmpty = scopes.some(function (s) {
        return s.length === 0;
      });
  if (hasEmpty) {
    return {
            TAG: "Error",
            _0: "InvalidScope"
          };
  }
  var results = scopes.map(validateScopeName);
  var hasError = results.some(function (r) {
        if (r.TAG === "Ok") {
          return false;
        } else {
          return true;
        }
      });
  if (hasError) {
    return {
            TAG: "Error",
            _0: "InvalidScope"
          };
  } else {
    return {
            TAG: "Ok",
            _0: undefined
          };
  }
}

function parseScopes(scopeString) {
  var e = validateScopeString(scopeString);
  if (e.TAG === "Ok") {
    if (scopeString.length === 0) {
      return {
              TAG: "Ok",
              _0: []
            };
    } else {
      return {
              TAG: "Ok",
              _0: scopeString.split(" ")
            };
    }
  } else {
    return {
            TAG: "Error",
            _0: e._0
          };
  }
}

function joinScopes(scopes) {
  if (scopes.length === 0) {
    return {
            TAG: "Ok",
            _0: ""
          };
  }
  var results = scopes.map(validateScopeName);
  var hasError = results.some(function (r) {
        if (r.TAG === "Ok") {
          return false;
        } else {
          return true;
        }
      });
  if (hasError) {
    return {
            TAG: "Error",
            _0: "InvalidScope"
          };
  }
  var joined = scopes.join(" ");
  if (joined.length > 1024) {
    return {
            TAG: "Error",
            _0: "InvalidScope"
          };
  } else {
    return {
            TAG: "Ok",
            _0: joined
          };
  }
}

function scopesContain(scopes, scope) {
  return scopes.includes(scope);
}

function scopesHaveAll(scopes, required) {
  return required.every(function (r) {
              return scopes.includes(r);
            });
}

function scopesHaveAny(scopes, candidates) {
  return candidates.some(function (c) {
              return scopes.includes(c);
            });
}

function validateClientId(clientId) {
  var len = clientId.length;
  if (len === 0 || len > 256) {
    return {
            TAG: "Error",
            _0: "InvalidClientId"
          };
  }
  var chars = clientId.split("");
  var allValid = chars.every(function (c) {
        var code = c.charCodeAt(0);
        if (code >= 32.0) {
          return code <= 126.0;
        } else {
          return false;
        }
      });
  if (allValid) {
    return {
            TAG: "Ok",
            _0: undefined
          };
  } else {
    return {
            TAG: "Error",
            _0: "InvalidClientId"
          };
  }
}

function validateState(state) {
  var len = state.length;
  if (len < 8 || len > 512) {
    return {
            TAG: "Error",
            _0: "InvalidState"
          };
  }
  var chars = state.split("");
  var allValid = chars.every(function (c) {
        var code = c.charCodeAt(0);
        if (code >= 32.0) {
          return code <= 126.0;
        } else {
          return false;
        }
      });
  if (allValid) {
    return {
            TAG: "Ok",
            _0: undefined
          };
  } else {
    return {
            TAG: "Error",
            _0: "InvalidState"
          };
  }
}

function validateCodeVerifier(verifier) {
  var len = verifier.length;
  if (len < 43 || len > 128) {
    return {
            TAG: "Error",
            _0: "InvalidCodeVerifier"
          };
  }
  var chars = verifier.split("");
  var allValid = chars.every(function (c) {
        var code = c.charCodeAt(0);
        return isPkceUnreservedChar(code);
      });
  if (allValid) {
    return {
            TAG: "Ok",
            _0: undefined
          };
  } else {
    return {
            TAG: "Error",
            _0: "InvalidCodeVerifier"
          };
  }
}

function validateCodeChallenge(challenge) {
  var len = challenge.length;
  if (len < 43 || len > 128) {
    return {
            TAG: "Error",
            _0: "InvalidCodeChallenge"
          };
  }
  var chars = challenge.split("");
  var allValid = chars.every(function (c) {
        var code = c.charCodeAt(0);
        return isBase64UrlChar(code);
      });
  if (allValid) {
    return {
            TAG: "Ok",
            _0: undefined
          };
  } else {
    return {
            TAG: "Error",
            _0: "InvalidCodeChallenge"
          };
  }
}

function validateRedirectUri(uri) {
  if (uri.length === 0) {
    return {
            TAG: "Error",
            _0: "InvalidRedirectUri"
          };
  }
  var isSecure = uri.startsWith("https://");
  var isLocalhost = uri.startsWith("http://localhost") || uri.startsWith("http://127.0.0.1");
  if (!isSecure && !isLocalhost || uri.includes("#")) {
    return {
            TAG: "Error",
            _0: "InvalidRedirectUri"
          };
  } else {
    return {
            TAG: "Ok",
            _0: undefined
          };
  }
}

function isOpenIdScope(scope) {
  switch (scope) {
    case "address" :
    case "email" :
    case "offline_access" :
    case "openid" :
    case "phone" :
    case "profile" :
        return true;
    default:
      return false;
  }
}

function extractBearerToken(header) {
  var prefix = "Bearer ";
  if (!header.startsWith(prefix)) {
    return {
            TAG: "Error",
            _0: "UnsupportedTokenType"
          };
  }
  var token = header.slice(prefix.length).trim();
  var e = validateAccessToken(token);
  if (e.TAG === "Ok") {
    return {
            TAG: "Ok",
            _0: token
          };
  } else {
    return {
            TAG: "Error",
            _0: e._0
          };
  }
}

function buildBearerHeader(token) {
  var e = validateAccessToken(token);
  if (e.TAG === "Ok") {
    return {
            TAG: "Ok",
            _0: "Bearer " + token
          };
  } else {
    return {
            TAG: "Error",
            _0: e._0
          };
  }
}

var maxTokenLength = 4096;

var maxScopeLength = 1024;

var maxScopeNameLength = 256;

var maxClientIdLength = 256;

var minStateLength = 8;

var maxStateLength = 512;

var pkceMinVerifierLength = 43;

var pkceMaxVerifierLength = 128;

export {
  maxTokenLength ,
  maxScopeLength ,
  maxScopeNameLength ,
  maxClientIdLength ,
  minStateLength ,
  maxStateLength ,
  pkceMinVerifierLength ,
  pkceMaxVerifierLength ,
  CommonScopes ,
  tokenTypeFromString ,
  tokenTypeToString ,
  grantTypeFromString ,
  grantTypeToString ,
  codeChallengeMethodFromString ,
  codeChallengeMethodToString ,
  errorCodeFromString ,
  errorCodeToString ,
  isValidTokenChar ,
  isNqchar ,
  isPkceUnreservedChar ,
  isBase64UrlChar ,
  validateAccessToken ,
  validateRefreshToken ,
  validateAuthorizationCode ,
  validateScopeName ,
  validateScopeString ,
  parseScopes ,
  joinScopes ,
  scopesContain ,
  scopesHaveAll ,
  scopesHaveAny ,
  validateClientId ,
  validateState ,
  validateCodeVerifier ,
  validateCodeChallenge ,
  validateRedirectUri ,
  isOpenIdScope ,
  extractBearerToken ,
  buildBearerHeader ,
}
/* No side effect */
