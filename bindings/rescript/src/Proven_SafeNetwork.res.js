// Generated by ReScript, PLEASE EDIT WITH CARE

import * as Belt_Int from "rescript/lib/es6/belt_Int.js";
import * as Belt_Array from "rescript/lib/es6/belt_Array.js";

function parseIpv4(address) {
  var parts = address.split(".");
  if (parts.length !== 4) {
    return ;
  }
  var valid = {
    contents: true
  };
  var octets = Belt_Array.map(parts, (function (part) {
          var n = Belt_Int.fromString(part);
          if (n !== undefined && n >= 0 && n <= 255) {
            return n;
          } else {
            valid.contents = false;
            return 0;
          }
        }));
  if (valid.contents) {
    return {
            octets: [
              octets[0],
              octets[1],
              octets[2],
              octets[3]
            ]
          };
  }
  
}

function isValidIpv4(address) {
  return parseIpv4(address) !== undefined;
}

function isPrivate(address) {
  var match = parseIpv4(address);
  if (match === undefined) {
    return false;
  }
  var match$1 = match.octets;
  var b = match$1[1];
  var a = match$1[0];
  if (a === 10 || a === 172 && b >= 16 && b <= 31) {
    return true;
  } else if (a === 192) {
    return b === 168;
  } else {
    return false;
  }
}

function isLoopback(address) {
  var match = parseIpv4(address);
  if (match !== undefined) {
    return match.octets[0] === 127;
  } else {
    return false;
  }
}

function isPublic(address) {
  if (isValidIpv4(address) && !isPrivate(address)) {
    return !isLoopback(address);
  } else {
    return false;
  }
}

function formatIpv4(param) {
  var match = param.octets;
  return String(match[0]) + "." + String(match[1]) + "." + String(match[2]) + "." + String(match[3]);
}

export {
  parseIpv4 ,
  isValidIpv4 ,
  isPrivate ,
  isLoopback ,
  isPublic ,
  formatIpv4 ,
}
/* No side effect */
