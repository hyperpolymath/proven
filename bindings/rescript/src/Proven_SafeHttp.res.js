// Generated by ReScript, PLEASE EDIT WITH CARE

import * as Belt_Option from "rescript/lib/es6/belt_Option.js";

function isSafe(m) {
  switch (m) {
    case "GET" :
    case "HEAD" :
    case "OPTIONS" :
    case "TRACE" :
        return true;
    default:
      return false;
  }
}

function isIdempotent(m) {
  switch (m) {
    case "POST" :
    case "CONNECT" :
    case "PATCH" :
        return false;
    default:
      return true;
  }
}

function hasRequestBody(m) {
  switch (m) {
    case "POST" :
    case "PUT" :
    case "PATCH" :
        return true;
    default:
      return false;
  }
}

function hasResponseBody(m) {
  if (m === "HEAD") {
    return false;
  } else {
    return true;
  }
}

function isCacheable(m) {
  switch (m) {
    case "GET" :
    case "HEAD" :
        return true;
    default:
      return false;
  }
}

function methodToString(m) {
  switch (m) {
    case "GET" :
        return "GET";
    case "HEAD" :
        return "HEAD";
    case "POST" :
        return "POST";
    case "PUT" :
        return "PUT";
    case "DELETE" :
        return "DELETE";
    case "CONNECT" :
        return "CONNECT";
    case "OPTIONS" :
        return "OPTIONS";
    case "TRACE" :
        return "TRACE";
    case "PATCH" :
        return "PATCH";
    
  }
}

function parseMethod(str) {
  var match = str.toUpperCase();
  switch (match) {
    case "CONNECT" :
        return "CONNECT";
    case "DELETE" :
        return "DELETE";
    case "GET" :
        return "GET";
    case "HEAD" :
        return "HEAD";
    case "OPTIONS" :
        return "OPTIONS";
    case "PATCH" :
        return "PATCH";
    case "POST" :
        return "POST";
    case "PUT" :
        return "PUT";
    case "TRACE" :
        return "TRACE";
    default:
      return ;
  }
}

function isValidMethod(str) {
  return Belt_Option.isSome(parseMethod(str));
}

function getStatusCategory(code) {
  if (code >= 100 && code < 200) {
    return "Informational";
  } else if (code >= 200 && code < 300) {
    return "Successful";
  } else if (code >= 300 && code < 400) {
    return "Redirection";
  } else if (code >= 400 && code < 500) {
    return "ClientError";
  } else if (code >= 500 && code < 600) {
    return "ServerError";
  } else {
    return ;
  }
}

function isErrorStatus(code) {
  if (code >= 400) {
    return code < 600;
  } else {
    return false;
  }
}

function isSuccessStatus(code) {
  if (code >= 200) {
    return code < 300;
  } else {
    return false;
  }
}

function isRedirectStatus(code) {
  if (code >= 300) {
    return code < 400;
  } else {
    return false;
  }
}

function statusHasBody(code) {
  return !(code === 204 || code === 304 || code === 100 || code === 101);
}

function getReasonPhrase(code) {
  if (code >= 227) {
    if (code >= 309) {
      switch (code) {
        case 400 :
            return "Bad Request";
        case 401 :
            return "Unauthorized";
        case 402 :
            return "Payment Required";
        case 403 :
            return "Forbidden";
        case 404 :
            return "Not Found";
        case 405 :
            return "Method Not Allowed";
        case 406 :
            return "Not Acceptable";
        case 407 :
            return "Proxy Authentication Required";
        case 408 :
            return "Request Timeout";
        case 409 :
            return "Conflict";
        case 410 :
            return "Gone";
        case 411 :
            return "Length Required";
        case 412 :
            return "Precondition Failed";
        case 413 :
            return "Payload Too Large";
        case 414 :
            return "URI Too Long";
        case 415 :
            return "Unsupported Media Type";
        case 416 :
            return "Range Not Satisfiable";
        case 417 :
            return "Expectation Failed";
        case 418 :
            return "I'm a teapot";
        case 421 :
            return "Misdirected Request";
        case 422 :
            return "Unprocessable Entity";
        case 423 :
            return "Locked";
        case 424 :
            return "Failed Dependency";
        case 425 :
            return "Too Early";
        case 426 :
            return "Upgrade Required";
        case 428 :
            return "Precondition Required";
        case 429 :
            return "Too Many Requests";
        case 431 :
            return "Request Header Fields Too Large";
        case 451 :
            return "Unavailable For Legal Reasons";
        case 500 :
            return "Internal Server Error";
        case 501 :
            return "Not Implemented";
        case 502 :
            return "Bad Gateway";
        case 503 :
            return "Service Unavailable";
        case 504 :
            return "Gateway Timeout";
        case 505 :
            return "HTTP Version Not Supported";
        case 506 :
            return "Variant Also Negotiates";
        case 507 :
            return "Insufficient Storage";
        case 508 :
            return "Loop Detected";
        case 510 :
            return "Not Extended";
        case 511 :
            return "Network Authentication Required";
        default:
          return ;
      }
    } else {
      if (code < 300) {
        return ;
      }
      switch (code) {
        case 300 :
            return "Multiple Choices";
        case 301 :
            return "Moved Permanently";
        case 302 :
            return "Found";
        case 303 :
            return "See Other";
        case 304 :
            return "Not Modified";
        case 305 :
            return "Use Proxy";
        case 306 :
            return ;
        case 307 :
            return "Temporary Redirect";
        case 308 :
            return "Permanent Redirect";
        
      }
    }
  } else if (code >= 104) {
    if (code < 200) {
      return ;
    }
    switch (code) {
      case 200 :
          return "OK";
      case 201 :
          return "Created";
      case 202 :
          return "Accepted";
      case 203 :
          return "Non-Authoritative Information";
      case 204 :
          return "No Content";
      case 205 :
          return "Reset Content";
      case 206 :
          return "Partial Content";
      case 207 :
          return "Multi-Status";
      case 208 :
          return "Already Reported";
      case 209 :
      case 210 :
      case 211 :
      case 212 :
      case 213 :
      case 214 :
      case 215 :
      case 216 :
      case 217 :
      case 218 :
      case 219 :
      case 220 :
      case 221 :
      case 222 :
      case 223 :
      case 224 :
      case 225 :
          return ;
      case 226 :
          return "IM Used";
      
    }
  } else {
    if (code < 100) {
      return ;
    }
    switch (code) {
      case 100 :
          return "Continue";
      case 101 :
          return "Switching Protocols";
      case 102 :
          return "Processing";
      case 103 :
          return "Early Hints";
      
    }
  }
}

function parseStatusCode(code) {
  var match = getStatusCategory(code);
  var match$1 = getReasonPhrase(code);
  if (match !== undefined) {
    if (match$1 !== undefined) {
      return {
              code: code,
              reasonPhrase: match$1,
              category: match
            };
    } else {
      return {
              code: code,
              reasonPhrase: "Unknown",
              category: match
            };
    }
  }
  
}

function isValidStatusCode(code) {
  if (code >= 100) {
    return code <= 599;
  } else {
    return false;
  }
}

function versionToString(v) {
  switch (v) {
    case "Http09" :
        return "HTTP/0.9";
    case "Http10" :
        return "HTTP/1.0";
    case "Http11" :
        return "HTTP/1.1";
    case "Http2" :
        return "HTTP/2";
    case "Http3" :
        return "HTTP/3";
    
  }
}

function parseVersion(str) {
  switch (str) {
    case "HTTP/0.9" :
        return "Http09";
    case "HTTP/1.0" :
        return "Http10";
    case "HTTP/1.1" :
        return "Http11";
    case "HTTP/2" :
    case "HTTP/2.0" :
        return "Http2";
    case "HTTP/3" :
    case "HTTP/3.0" :
        return "Http3";
    default:
      return ;
  }
}

function supportsKeepAlive(v) {
  switch (v) {
    case "Http09" :
    case "Http10" :
        return false;
    default:
      return true;
  }
}

function supportsPipelining(v) {
  if (v === "Http11") {
    return true;
  } else {
    return false;
  }
}

function supportsMultiplexing(v) {
  switch (v) {
    case "Http2" :
    case "Http3" :
        return true;
    default:
      return false;
  }
}

function formatStatusLine(version, code) {
  var reason = getReasonPhrase(code);
  if (reason !== undefined) {
    return versionToString(version) + " " + String(code) + " " + reason;
  }
  
}

function formatRequestLine(m, path, version) {
  return methodToString(m) + " " + path + " " + versionToString(version);
}

function isMethodAllowed(m, allowed) {
  return allowed.includes(m);
}

var StatusCodes = {
  ok: 200,
  created: 201,
  accepted: 202,
  noContent: 204,
  movedPermanently: 301,
  found: 302,
  notModified: 304,
  badRequest: 400,
  unauthorized: 401,
  forbidden: 403,
  notFound: 404,
  methodNotAllowed: 405,
  conflict: 409,
  gone: 410,
  unprocessableEntity: 422,
  tooManyRequests: 429,
  internalServerError: 500,
  notImplemented: 501,
  badGateway: 502,
  serviceUnavailable: 503,
  gatewayTimeout: 504
};

export {
  isSafe ,
  isIdempotent ,
  hasRequestBody ,
  hasResponseBody ,
  isCacheable ,
  methodToString ,
  parseMethod ,
  isValidMethod ,
  getStatusCategory ,
  isErrorStatus ,
  isSuccessStatus ,
  isRedirectStatus ,
  statusHasBody ,
  getReasonPhrase ,
  parseStatusCode ,
  isValidStatusCode ,
  versionToString ,
  parseVersion ,
  supportsKeepAlive ,
  supportsPipelining ,
  supportsMultiplexing ,
  formatStatusLine ,
  formatRequestLine ,
  isMethodAllowed ,
  StatusCodes ,
}
/* No side effect */
