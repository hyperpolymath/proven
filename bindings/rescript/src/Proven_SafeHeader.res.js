// Generated by ReScript, PLEASE EDIT WITH CARE


function hasCRLF(s) {
  if (s.includes("\r")) {
    return true;
  } else {
    return s.includes("\n");
  }
}

function isValidTokenChar(c) {
  var code = c.charCodeAt(0);
  if (code >= 33.0 && code <= 126.0) {
    return !"()<>@,;:\\\"/[]?=".includes(c);
  } else {
    return false;
  }
}

function isValidName(name) {
  if (name.length === 0 || name.length > 256) {
    return false;
  } else {
    return name.split("").every(isValidTokenChar);
  }
}

var dangerousHeaders = [
  "proxy-authorization",
  "proxy-authenticate",
  "proxy-connection",
  "transfer-encoding",
  "content-length",
  "host",
  "connection",
  "keep-alive",
  "upgrade",
  "te",
  "trailer"
];

function isDangerous(name) {
  return dangerousHeaders.includes(name.toLowerCase());
}

function make(name, value) {
  var trimmedName = name.trim();
  var trimmedValue = value.trim();
  if (!isValidName(trimmedName) || hasCRLF(trimmedValue) || trimmedValue.length > 8192) {
    return ;
  } else {
    return {
            name: trimmedName,
            value: trimmedValue
          };
  }
}

function makeSafe(name, value) {
  if (dangerousHeaders.includes(name.toLowerCase())) {
    return ;
  } else {
    return make(name, value);
  }
}

function render(h) {
  return h.name + ": " + h.value;
}

function buildCSP(directives) {
  return directives.map(function (param) {
                var sources = param[1];
                var name = param[0];
                if (sources.length === 0) {
                  return name;
                } else {
                  return name + " " + sources.join(" ");
                }
              }).join("; ");
}

function buildHSTS(maxAge, includeSubDomains, preload) {
  var base = "max-age=" + String(maxAge);
  var withSub = includeSubDomains ? base + "; includeSubDomains" : base;
  if (preload) {
    return withSub + "; preload";
  } else {
    return withSub;
  }
}

function securityHeaders() {
  return [
          {
            name: "X-Frame-Options",
            value: "DENY"
          },
          {
            name: "X-Content-Type-Options",
            value: "nosniff"
          },
          {
            name: "Referrer-Policy",
            value: "strict-origin-when-cross-origin"
          },
          {
            name: "X-XSS-Protection",
            value: "1; mode=block"
          }
        ];
}

export {
  hasCRLF ,
  isValidTokenChar ,
  isValidName ,
  dangerousHeaders ,
  isDangerous ,
  make ,
  makeSafe ,
  render ,
  buildCSP ,
  buildHSTS ,
  securityHeaders ,
}
/* No side effect */
