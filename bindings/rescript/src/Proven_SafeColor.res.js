// Generated by ReScript, PLEASE EDIT WITH CARE


function clampByte(n) {
  if (n < 0) {
    return 0;
  } else if (n > 255) {
    return 255;
  } else {
    return n;
  }
}

function clampUnit(n) {
  if (n < 0.0) {
    return 0.0;
  } else if (n > 1.0) {
    return 1.0;
  } else {
    return n;
  }
}

function makeRgb(r, g, b) {
  return {
          r: clampByte(r),
          g: clampByte(g),
          b: clampByte(b)
        };
}

function makeRgba(r, g, b, a) {
  return {
          r: clampByte(r),
          g: clampByte(g),
          b: clampByte(b),
          a: clampUnit(a)
        };
}

function fromHex(hex) {
  var hex$1 = hex.startsWith("#") ? hex.slice(1) : hex;
  var parseHexByte = function (s) {
    var parsed = parseInt(s, 16);
    if (Number.isNaN(parsed)) {
      return ;
    } else {
      return parsed | 0;
    }
  };
  var len = hex$1.length;
  switch (len) {
    case 3 :
        var r = hex$1.slice(0, 1);
        var g = hex$1.slice(1, 2);
        var b = hex$1.slice(2, 3);
        var match = parseHexByte(r + r);
        var match$1 = parseHexByte(g + g);
        var match$2 = parseHexByte(b + b);
        if (match !== undefined && match$1 !== undefined && match$2 !== undefined) {
          return {
                  r: match,
                  g: match$1,
                  b: match$2,
                  a: 1.0
                };
        } else {
          return ;
        }
    case 4 :
        var r$1 = hex$1.slice(0, 1);
        var g$1 = hex$1.slice(1, 2);
        var b$1 = hex$1.slice(2, 3);
        var a = hex$1.slice(3, 4);
        var match$3 = parseHexByte(r$1 + r$1);
        var match$4 = parseHexByte(g$1 + g$1);
        var match$5 = parseHexByte(b$1 + b$1);
        var match$6 = parseHexByte(a + a);
        if (match$3 !== undefined && match$4 !== undefined && match$5 !== undefined && match$6 !== undefined) {
          return {
                  r: match$3,
                  g: match$4,
                  b: match$5,
                  a: match$6 / 255.0
                };
        } else {
          return ;
        }
    case 6 :
        var r$2 = hex$1.slice(0, 2);
        var g$2 = hex$1.slice(2, 4);
        var b$2 = hex$1.slice(4, 6);
        var match$7 = parseHexByte(r$2);
        var match$8 = parseHexByte(g$2);
        var match$9 = parseHexByte(b$2);
        if (match$7 !== undefined && match$8 !== undefined && match$9 !== undefined) {
          return {
                  r: match$7,
                  g: match$8,
                  b: match$9,
                  a: 1.0
                };
        } else {
          return ;
        }
    case 8 :
        var r$3 = hex$1.slice(0, 2);
        var g$3 = hex$1.slice(2, 4);
        var b$3 = hex$1.slice(4, 6);
        var a$1 = hex$1.slice(6, 8);
        var match$10 = parseHexByte(r$3);
        var match$11 = parseHexByte(g$3);
        var match$12 = parseHexByte(b$3);
        var match$13 = parseHexByte(a$1);
        if (match$10 !== undefined && match$11 !== undefined && match$12 !== undefined && match$13 !== undefined) {
          return {
                  r: match$10,
                  g: match$11,
                  b: match$12,
                  a: match$13 / 255.0
                };
        } else {
          return ;
        }
    default:
      return ;
  }
}

function toHex(color) {
  var toHexByte = function (n) {
    var hex = n.toString(16);
    if (hex.length === 1) {
      return "0" + hex;
    } else {
      return hex;
    }
  };
  if (color.a >= 1.0) {
    return "#" + toHexByte(color.r) + toHexByte(color.g) + toHexByte(color.b);
  }
  var alphaByte = color.a * 255.0 | 0;
  return "#" + toHexByte(color.r) + toHexByte(color.g) + toHexByte(color.b) + toHexByte(alphaByte);
}

function rgbToHsl(color) {
  var r = color.r / 255.0;
  var g = color.g / 255.0;
  var b = color.b / 255.0;
  var max = Math.max(Math.max(r, g), b);
  var min = Math.min(Math.min(r, g), b);
  var l = (max + min) / 2.0;
  if (max === min) {
    return {
            h: 0.0,
            s: 0.0,
            l: l
          };
  }
  var d = max - min;
  var s = l > 0.5 ? d / (2.0 - max - min) : d / (max + min);
  var h = max === r ? (g - b) / d + (
      g < b ? 6.0 : 0.0
    ) : (
      max === g ? (b - r) / d + 2.0 : (r - g) / d + 4.0
    );
  return {
          h: h * 60.0,
          s: s,
          l: l
        };
}

function hslToRgb(color) {
  var hueToRgb = function (p, q, t) {
    var t$1 = t < 0.0 ? t + 1.0 : (
        t > 1.0 ? t - 1.0 : t
      );
    if (t$1 < 1.0 / 6.0) {
      return p + (q - p) * 6.0 * t$1;
    } else if (t$1 < 1.0 / 2.0) {
      return q;
    } else if (t$1 < 2.0 / 3.0) {
      return p + (q - p) * (2.0 / 3.0 - t$1) * 6.0;
    } else {
      return p;
    }
  };
  if (color.s === 0.0) {
    var v = color.l * 255.0 | 0;
    return {
            r: v,
            g: v,
            b: v
          };
  }
  var q = color.l < 0.5 ? color.l * (1.0 + color.s) : color.l + color.s - color.l * color.s;
  var p = 2.0 * color.l - q;
  var h = color.h / 360.0;
  return {
          r: hueToRgb(p, q, h + 1.0 / 3.0) * 255.0 | 0,
          g: hueToRgb(p, q, h) * 255.0 | 0,
          b: hueToRgb(p, q, h - 1.0 / 3.0) * 255.0 | 0
        };
}

function luminance(color) {
  var adjust = function (c) {
    var c$1 = c / 255.0;
    if (c$1 <= 0.03928) {
      return c$1 / 12.92;
    } else {
      return Math.pow((c$1 + 0.055) / 1.055, 2.4);
    }
  };
  var r = adjust(color.r);
  var g = adjust(color.g);
  var b = adjust(color.b);
  return 0.2126 * r + 0.7152 * g + 0.0722 * b;
}

function contrastRatio(a, b) {
  var lumA = luminance(a);
  var lumB = luminance(b);
  var lighter = Math.max(lumA, lumB);
  var darker = Math.min(lumA, lumB);
  return (lighter + 0.05) / (darker + 0.05);
}

function meetsWcagAA(foreground, background) {
  return contrastRatio(foreground, background) >= 4.5;
}

function meetsWcagAALarge(foreground, background) {
  return contrastRatio(foreground, background) >= 3.0;
}

function meetsWcagAAA(foreground, background) {
  return contrastRatio(foreground, background) >= 7.0;
}

function meetsWcagAAALarge(foreground, background) {
  return contrastRatio(foreground, background) >= 4.5;
}

function lighten(color, amount) {
  var hsl = rgbToHsl(color);
  var newL = clampUnit(hsl.l + amount);
  return hslToRgb({
              h: hsl.h,
              s: hsl.s,
              l: newL
            });
}

function darken(color, amount) {
  var hsl = rgbToHsl(color);
  var newL = clampUnit(hsl.l - amount);
  return hslToRgb({
              h: hsl.h,
              s: hsl.s,
              l: newL
            });
}

function saturate(color, amount) {
  var hsl = rgbToHsl(color);
  var newS = clampUnit(hsl.s + amount);
  return hslToRgb({
              h: hsl.h,
              s: newS,
              l: hsl.l
            });
}

function desaturate(color, amount) {
  var hsl = rgbToHsl(color);
  var newS = clampUnit(hsl.s - amount);
  return hslToRgb({
              h: hsl.h,
              s: newS,
              l: hsl.l
            });
}

function invert(color) {
  return {
          r: 255 - color.r | 0,
          g: 255 - color.g | 0,
          b: 255 - color.b | 0
        };
}

function grayscale(color) {
  var gray = luminance(color) * 255.0 | 0;
  return {
          r: gray,
          g: gray,
          b: gray
        };
}

function mix(a, b, ratio) {
  var ratio$1 = clampUnit(ratio);
  var r = a.r * (1.0 - ratio$1) + b.r * ratio$1 | 0;
  var g = a.g * (1.0 - ratio$1) + b.g * ratio$1 | 0;
  var bl = a.b * (1.0 - ratio$1) + b.b * ratio$1 | 0;
  return {
          r: clampByte(r),
          g: clampByte(g),
          b: clampByte(bl)
        };
}

var black = {
  r: 0,
  g: 0,
  b: 0
};

var white = {
  r: 255,
  g: 255,
  b: 255
};

var red = {
  r: 255,
  g: 0,
  b: 0
};

var green = {
  r: 0,
  g: 128,
  b: 0
};

var blue = {
  r: 0,
  g: 0,
  b: 255
};

var yellow = {
  r: 255,
  g: 255,
  b: 0
};

var cyan = {
  r: 0,
  g: 255,
  b: 255
};

var magenta = {
  r: 255,
  g: 0,
  b: 255
};

export {
  clampByte ,
  clampUnit ,
  makeRgb ,
  makeRgba ,
  fromHex ,
  toHex ,
  rgbToHsl ,
  hslToRgb ,
  luminance ,
  contrastRatio ,
  meetsWcagAA ,
  meetsWcagAALarge ,
  meetsWcagAAA ,
  meetsWcagAAALarge ,
  lighten ,
  darken ,
  saturate ,
  desaturate ,
  invert ,
  grayscale ,
  mix ,
  black ,
  white ,
  red ,
  green ,
  blue ,
  yellow ,
  cyan ,
  magenta ,
}
/* No side effect */
