// Generated by ReScript, PLEASE EDIT WITH CARE


var initialize = "initialize";

var initialized = "notifications/initialized";

var shutdown = "shutdown";

var toolsList = "tools/list";

var toolsCall = "tools/call";

var resourcesList = "resources/list";

var resourcesRead = "resources/read";

var resourcesSubscribe = "resources/subscribe";

var resourcesUnsubscribe = "resources/unsubscribe";

var promptsList = "prompts/list";

var promptsGet = "prompts/get";

var loggingSetLevel = "logging/setLevel";

var notificationCancelled = "notifications/cancelled";

var notificationProgress = "notifications/progress";

var notificationMessage = "notifications/message";

var notificationResourcesUpdated = "notifications/resources/updated";

var notificationResourcesListChanged = "notifications/resources/list_changed";

var notificationToolsListChanged = "notifications/tools/list_changed";

var notificationPromptsListChanged = "notifications/prompts/list_changed";

var samplingCreateMessage = "sampling/createMessage";

var completionComplete = "completion/complete";

var StandardMethods = {
  initialize: initialize,
  initialized: initialized,
  shutdown: shutdown,
  toolsList: toolsList,
  toolsCall: toolsCall,
  resourcesList: resourcesList,
  resourcesRead: resourcesRead,
  resourcesSubscribe: resourcesSubscribe,
  resourcesUnsubscribe: resourcesUnsubscribe,
  promptsList: promptsList,
  promptsGet: promptsGet,
  loggingSetLevel: loggingSetLevel,
  notificationCancelled: notificationCancelled,
  notificationProgress: notificationProgress,
  notificationMessage: notificationMessage,
  notificationResourcesUpdated: notificationResourcesUpdated,
  notificationResourcesListChanged: notificationResourcesListChanged,
  notificationToolsListChanged: notificationToolsListChanged,
  notificationPromptsListChanged: notificationPromptsListChanged,
  samplingCreateMessage: samplingCreateMessage,
  completionComplete: completionComplete
};

var ErrorCodes = {
  parseError: -32700,
  invalidRequest: -32600,
  methodNotFound: -32601,
  invalidParams: -32602,
  internalError: -32603
};

function validateJsonRpcVersion(version) {
  if (version === "2.0") {
    return {
            TAG: "Ok",
            _0: undefined
          };
  } else {
    return {
            TAG: "Error",
            _0: "InvalidJsonRpcVersion"
          };
  }
}

function isValidMethodChar(c) {
  var code = c.charCodeAt(0);
  if (code >= 48.0 && code <= 57.0 || code >= 65.0 && code <= 90.0 || code >= 97.0 && code <= 122.0 || code === 47.0 || code === 95.0 || code === 45.0) {
    return true;
  } else {
    return code === 46.0;
  }
}

function validateMethod(method) {
  var length = method.length;
  if (length === 0 || length > 256) {
    return {
            TAG: "Error",
            _0: "InvalidMethod"
          };
  }
  var chars = method.split("");
  var allValid = chars.every(isValidMethodChar);
  if (allValid) {
    return {
            TAG: "Ok",
            _0: undefined
          };
  } else {
    return {
            TAG: "Error",
            _0: "InvalidMethod"
          };
  }
}

function isNotificationMethod(method) {
  return method.startsWith("notifications/");
}

function isStandardMethod(method) {
  var standardMethods = [
    initialize,
    initialized,
    shutdown,
    toolsList,
    toolsCall,
    resourcesList,
    resourcesRead,
    resourcesSubscribe,
    resourcesUnsubscribe,
    promptsList,
    promptsGet,
    loggingSetLevel,
    notificationCancelled,
    notificationProgress,
    notificationMessage,
    notificationResourcesUpdated,
    notificationResourcesListChanged,
    notificationToolsListChanged,
    notificationPromptsListChanged,
    samplingCreateMessage,
    completionComplete
  ];
  return standardMethods.includes(method);
}

function isValidNameFirstChar(c) {
  var code = c.charCodeAt(0);
  if (code >= 65.0 && code <= 90.0 || code >= 97.0 && code <= 122.0) {
    return true;
  } else {
    return code === 95.0;
  }
}

function isValidNameChar(c) {
  var code = c.charCodeAt(0);
  if (code >= 48.0 && code <= 57.0 || code >= 65.0 && code <= 90.0 || code >= 97.0 && code <= 122.0 || code === 95.0) {
    return true;
  } else {
    return code === 45.0;
  }
}

function validateToolName(name) {
  var length = name.length;
  if (length === 0 || length > 128) {
    return {
            TAG: "Error",
            _0: "InvalidToolName"
          };
  }
  var firstChar = name.charAt(0);
  if (!isValidNameFirstChar(firstChar)) {
    return {
            TAG: "Error",
            _0: "InvalidToolName"
          };
  }
  var rest = name.slice(1);
  var chars = rest.split("");
  var allValid = chars.every(isValidNameChar);
  if (allValid) {
    return {
            TAG: "Ok",
            _0: undefined
          };
  } else {
    return {
            TAG: "Error",
            _0: "InvalidToolName"
          };
  }
}

function validatePromptName(name) {
  var length = name.length;
  if (length === 0 || length > 128) {
    return {
            TAG: "Error",
            _0: "InvalidPromptName"
          };
  }
  var firstChar = name.charAt(0);
  if (!isValidNameFirstChar(firstChar)) {
    return {
            TAG: "Error",
            _0: "InvalidPromptName"
          };
  }
  var rest = name.slice(1);
  var chars = rest.split("");
  var allValid = chars.every(isValidNameChar);
  if (allValid) {
    return {
            TAG: "Ok",
            _0: undefined
          };
  } else {
    return {
            TAG: "Error",
            _0: "InvalidPromptName"
          };
  }
}

function validateResourceUri(uri) {
  var length = uri.length;
  if (length === 0 || length > 2048) {
    return {
            TAG: "Error",
            _0: "InvalidResourceUri"
          };
  }
  var schemeEnd = uri.indexOf("://");
  if (schemeEnd === -1 || schemeEnd === 0) {
    return {
            TAG: "Error",
            _0: "InvalidResourceUri"
          };
  }
  var scheme = uri.slice(0, schemeEnd);
  var schemeChars = scheme.split("");
  var validScheme = schemeChars.every(function (c) {
        var code = c.charCodeAt(0);
        if (code >= 48.0 && code <= 57.0 || code >= 65.0 && code <= 90.0 || code >= 97.0 && code <= 122.0 || code === 43.0 || code === 45.0) {
          return true;
        } else {
          return code === 46.0;
        }
      });
  if (!validScheme || length <= (schemeEnd + 3 | 0)) {
    return {
            TAG: "Error",
            _0: "InvalidResourceUri"
          };
  } else {
    return {
            TAG: "Ok",
            _0: undefined
          };
  }
}

function validateId(id) {
  if (id.length === 0) {
    return {
            TAG: "Error",
            _0: "InvalidId"
          };
  } else {
    return {
            TAG: "Ok",
            _0: undefined
          };
  }
}

function validateErrorCode(code) {
  if (code >= -32603) {
    if (code < -32599) {
      return true;
    }
    
  } else if (code === -32700) {
    return true;
  }
  if (code >= -32099 && code <= -32000 || code < -32099) {
    return true;
  } else {
    return code > -32000;
  }
}

function errorCodeMessage(code) {
  if (code < -32603) {
    if (code !== -32700) {
      return ;
    } else {
      return "Parse error";
    }
  }
  if (code >= -32599) {
    return ;
  }
  switch (code) {
    case -32603 :
        return "Internal error";
    case -32602 :
        return "Invalid params";
    case -32601 :
        return "Method not found";
    case -32600 :
        return "Invalid Request";
    
  }
}

function validateMessageSize(size) {
  if (size > 10485760) {
    return {
            TAG: "Error",
            _0: "MessageTooLarge"
          };
  } else {
    return {
            TAG: "Ok",
            _0: undefined
          };
  }
}

function detectMessageType(hasId, hasMethod, hasResult, hasError) {
  if (hasMethod && hasId && !hasResult && !hasError) {
    return "Request";
  } else if (hasMethod && !hasId && !hasResult && !hasError) {
    return "Notification";
  } else if (hasId && hasResult && !hasMethod && !hasError) {
    return "Response";
  } else if (hasId && hasError && !hasMethod && !hasResult || hasError && !hasMethod && !hasResult) {
    return "ErrorResponse";
  } else {
    return ;
  }
}

function parseContentType(s) {
  switch (s) {
    case "image" :
        return "Image";
    case "resource" :
        return "Resource";
    case "text" :
        return "Text";
    default:
      return ;
  }
}

function contentTypeToString(ct) {
  switch (ct) {
    case "Text" :
        return "text";
    case "Image" :
        return "image";
    case "Resource" :
        return "resource";
    
  }
}

function parseLogLevel(s) {
  switch (s) {
    case "alert" :
        return "Alert";
    case "critical" :
        return "Critical";
    case "debug" :
        return "Debug";
    case "emergency" :
        return "Emergency";
    case "error" :
        return "Error";
    case "info" :
        return "Info";
    case "notice" :
        return "Notice";
    case "warning" :
        return "Warning";
    default:
      return ;
  }
}

function logLevelSeverity(level) {
  switch (level) {
    case "Debug" :
        return 0;
    case "Info" :
        return 1;
    case "Notice" :
        return 2;
    case "Warning" :
        return 3;
    case "Error" :
        return 4;
    case "Critical" :
        return 5;
    case "Alert" :
        return 6;
    case "Emergency" :
        return 7;
    
  }
}

function isSupportedProtocolVersion(version) {
  var supported = [
    "2024-11-05",
    "2024-10-07"
  ];
  return supported.includes(version);
}

function defaultServerCapabilities() {
  return {
          tools: true,
          resources: true,
          prompts: true,
          logging: true,
          sampling: false,
          experimental: undefined
        };
}

function defaultClientCapabilities() {
  return {
          tools: false,
          resources: false,
          prompts: false,
          logging: false,
          sampling: true,
          experimental: undefined
        };
}

function validateRequest(jsonrpc, id, method) {
  var e = validateJsonRpcVersion(jsonrpc);
  if (e.TAG !== "Ok") {
    return {
            TAG: "Error",
            _0: e._0
          };
  }
  var e$1 = validateId(id);
  if (e$1.TAG !== "Ok") {
    return {
            TAG: "Error",
            _0: e$1._0
          };
  }
  var e$2 = validateMethod(method);
  if (e$2.TAG === "Ok") {
    return {
            TAG: "Ok",
            _0: {
              id: id,
              method: method,
              hasParams: false
            }
          };
  } else {
    return {
            TAG: "Error",
            _0: e$2._0
          };
  }
}

function validateNotification(jsonrpc, method) {
  var e = validateJsonRpcVersion(jsonrpc);
  if (e.TAG !== "Ok") {
    return {
            TAG: "Error",
            _0: e._0
          };
  }
  var e$1 = validateMethod(method);
  if (e$1.TAG === "Ok") {
    return {
            TAG: "Ok",
            _0: {
              method: method,
              hasParams: false
            }
          };
  } else {
    return {
            TAG: "Error",
            _0: e$1._0
          };
  }
}

function createErrorResponse(id, code, message) {
  return {
          id: id,
          code: code,
          message: message,
          hasData: false
        };
}

function parseErrorResponse() {
  return createErrorResponse(undefined, -32700, "Parse error");
}

function invalidRequestResponse(id) {
  return createErrorResponse(id, -32600, "Invalid Request");
}

function methodNotFoundResponse(id, method) {
  return createErrorResponse(id, -32601, "Method not found: " + method);
}

function invalidParamsResponse(id) {
  return createErrorResponse(id, -32602, "Invalid params");
}

function internalErrorResponse(id) {
  return createErrorResponse(id, -32603, "Internal error");
}

var maxMessageSize = 10485760;

var maxMethodLength = 256;

var maxNameLength = 128;

var maxUriLength = 2048;

var protocolVersion = "2024-11-05";

export {
  maxMessageSize ,
  maxMethodLength ,
  maxNameLength ,
  maxUriLength ,
  protocolVersion ,
  StandardMethods ,
  ErrorCodes ,
  validateJsonRpcVersion ,
  isValidMethodChar ,
  validateMethod ,
  isNotificationMethod ,
  isStandardMethod ,
  isValidNameFirstChar ,
  isValidNameChar ,
  validateToolName ,
  validatePromptName ,
  validateResourceUri ,
  validateId ,
  validateErrorCode ,
  errorCodeMessage ,
  validateMessageSize ,
  detectMessageType ,
  parseContentType ,
  contentTypeToString ,
  parseLogLevel ,
  logLevelSeverity ,
  isSupportedProtocolVersion ,
  defaultServerCapabilities ,
  defaultClientCapabilities ,
  validateRequest ,
  validateNotification ,
  createErrorResponse ,
  parseErrorResponse ,
  invalidRequestResponse ,
  methodNotFoundResponse ,
  invalidParamsResponse ,
  internalErrorResponse ,
}
/* No side effect */
