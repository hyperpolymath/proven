// Generated by ReScript, PLEASE EDIT WITH CARE

import * as Js_dict from "rescript/lib/es6/js_dict.js";
import * as Belt_Int from "rescript/lib/es6/belt_Int.js";
import * as Belt_Array from "rescript/lib/es6/belt_Array.js";
import * as Belt_Option from "rescript/lib/es6/belt_Option.js";
import * as Js_null_undefined from "rescript/lib/es6/js_null_undefined.js";

function getEnvUnsafe(name) {
  return Js_null_undefined.fromOption(Js_dict.get(process.env, name));
}

function isValidName(name) {
  var len = name.length;
  if (len === 0 || len > 255 || name.includes("=")) {
    return false;
  } else {
    return !name.includes("\x00");
  }
}

function isValidValue(value) {
  var len = value.length;
  if (len > 32767) {
    return false;
  } else {
    return !value.includes("\x00");
  }
}

function get(name) {
  if (isValidName(name)) {
    return Js_dict.get(process.env, name);
  }
  
}

function getOrDefault(name, $$default) {
  var v = get(name);
  if (v !== undefined) {
    return v;
  } else {
    return $$default;
  }
}

function getRequired(name) {
  if (!isValidName(name)) {
    return {
            TAG: "Error",
            _0: "InvalidName"
          };
  }
  var v = get(name);
  if (v !== undefined) {
    return {
            TAG: "Ok",
            _0: v
          };
  } else {
    return {
            TAG: "Error",
            _0: "NotFound"
          };
  }
}

function getInt(name) {
  var value = get(name);
  if (value === undefined) {
    return {
            TAG: "Error",
            _0: "NotFound"
          };
  }
  var i = Belt_Int.fromString(value);
  if (i !== undefined) {
    return {
            TAG: "Ok",
            _0: i
          };
  } else {
    return {
            TAG: "Error",
            _0: "ParseError"
          };
  }
}

function getIntOrDefault(name, $$default) {
  var i = getInt(name);
  if (i.TAG === "Ok") {
    return i._0;
  } else {
    return $$default;
  }
}

function getBool(name) {
  var value = get(name);
  if (value === undefined) {
    return {
            TAG: "Error",
            _0: "NotFound"
          };
  }
  var lower = value.toLowerCase();
  if (lower === "true" || lower === "1" || lower === "yes") {
    return {
            TAG: "Ok",
            _0: true
          };
  } else if (lower === "false" || lower === "0" || lower === "no") {
    return {
            TAG: "Ok",
            _0: false
          };
  } else {
    return {
            TAG: "Error",
            _0: "ParseError"
          };
  }
}

function getBoolOrDefault(name, $$default) {
  var b = getBool(name);
  if (b.TAG === "Ok") {
    return b._0;
  } else {
    return $$default;
  }
}

function getFloat(name) {
  var value = get(name);
  if (value === undefined) {
    return {
            TAG: "Error",
            _0: "NotFound"
          };
  }
  var f = Number(value);
  if (Number.isNaN(f)) {
    return {
            TAG: "Error",
            _0: "ParseError"
          };
  } else {
    return {
            TAG: "Ok",
            _0: f
          };
  }
}

function getFloatOrDefault(name, $$default) {
  var f = getFloat(name);
  if (f.TAG === "Ok") {
    return f._0;
  } else {
    return $$default;
  }
}

function getSplit(name, delimiter) {
  var value = get(name);
  if (value !== undefined) {
    return {
            TAG: "Ok",
            _0: value.split(delimiter)
          };
  } else {
    return {
            TAG: "Error",
            _0: "NotFound"
          };
  }
}

function getSplitOrDefault(name, delimiter, $$default) {
  var parts = getSplit(name, delimiter);
  if (parts.TAG === "Ok") {
    return parts._0;
  } else {
    return $$default;
  }
}

function sanitizeValue(value) {
  var result = "";
  var len = value.length;
  for(var i = 0; i < len; ++i){
    var code = value.charCodeAt(i) | 0;
    if ((code >= 32 || code === 9 || code === 10 || code === 13) && code !== 127) {
      result = result + value.charAt(i);
    }
    
  }
  return result;
}

function exists(name) {
  return Belt_Option.isSome(get(name));
}

function existsNonEmpty(name) {
  var value = get(name);
  if (value !== undefined) {
    return value.length > 0;
  } else {
    return false;
  }
}

function getNonEmpty(name) {
  var e = getRequired(name);
  if (e.TAG !== "Ok") {
    return {
            TAG: "Error",
            _0: e._0
          };
  }
  var value = e._0;
  if (value.length === 0) {
    return {
            TAG: "Error",
            _0: "EmptyValue"
          };
  } else {
    return {
            TAG: "Ok",
            _0: value
          };
  }
}

function getNames() {
  return Object.keys(process.env);
}

function getAll() {
  return Js_dict.entries(process.env);
}

function isProduction() {
  var env = get("NODE_ENV");
  if (env !== undefined) {
    return env.toLowerCase() === "production";
  } else {
    return false;
  }
}

function isDevelopment() {
  var env = get("NODE_ENV");
  if (env !== undefined) {
    return env.toLowerCase() === "development";
  } else {
    return false;
  }
}

function isTest() {
  var env = get("NODE_ENV");
  if (env !== undefined) {
    return env.toLowerCase() === "test";
  } else {
    return false;
  }
}

function isDebug() {
  return getBoolOrDefault("DEBUG", false);
}

function getEnvironment() {
  return getOrDefault("NODE_ENV", "development");
}

function getPort($$default) {
  return getIntOrDefault("PORT", $$default);
}

function getHost($$default) {
  return getOrDefault("HOST", $$default);
}

function validateRequired(names) {
  var missing = Belt_Array.keep(names, (function (name) {
          return !existsNonEmpty(name);
        }));
  if (missing.length === 0) {
    return {
            TAG: "Ok",
            _0: undefined
          };
  } else {
    return {
            TAG: "Error",
            _0: missing
          };
  }
}

function getConfigValue(name, valueType) {
  switch (valueType) {
    case "array" :
        var arr = getSplit(name, ",");
        if (arr.TAG === "Ok") {
          return {
                  TAG: "Ok",
                  _0: {
                    TAG: "ArrayValue",
                    _0: arr._0
                  }
                };
        } else {
          return {
                  TAG: "Error",
                  _0: arr._0
                };
        }
    case "bool" :
        var b = getBool(name);
        if (b.TAG === "Ok") {
          return {
                  TAG: "Ok",
                  _0: {
                    TAG: "BoolValue",
                    _0: b._0
                  }
                };
        } else {
          return {
                  TAG: "Error",
                  _0: b._0
                };
        }
    case "float" :
        var f = getFloat(name);
        if (f.TAG === "Ok") {
          return {
                  TAG: "Ok",
                  _0: {
                    TAG: "FloatValue",
                    _0: f._0
                  }
                };
        } else {
          return {
                  TAG: "Error",
                  _0: f._0
                };
        }
    case "int" :
        var i = getInt(name);
        if (i.TAG === "Ok") {
          return {
                  TAG: "Ok",
                  _0: {
                    TAG: "IntValue",
                    _0: i._0
                  }
                };
        } else {
          return {
                  TAG: "Error",
                  _0: i._0
                };
        }
    case "string" :
        var v = get(name);
        if (v !== undefined) {
          return {
                  TAG: "Ok",
                  _0: {
                    TAG: "StringValue",
                    _0: v
                  }
                };
        } else {
          return {
                  TAG: "Error",
                  _0: "NotFound"
                };
        }
    default:
      return {
              TAG: "Error",
              _0: "ParseError"
            };
  }
}

var maxNameLength = 255;

var maxValueLength = 32767;

export {
  maxNameLength ,
  maxValueLength ,
  getEnvUnsafe ,
  isValidName ,
  isValidValue ,
  get ,
  getOrDefault ,
  getRequired ,
  getInt ,
  getIntOrDefault ,
  getBool ,
  getBoolOrDefault ,
  getFloat ,
  getFloatOrDefault ,
  getSplit ,
  getSplitOrDefault ,
  sanitizeValue ,
  exists ,
  existsNonEmpty ,
  getNonEmpty ,
  getNames ,
  getAll ,
  isProduction ,
  isDevelopment ,
  isTest ,
  isDebug ,
  getEnvironment ,
  getPort ,
  getHost ,
  validateRequired ,
  getConfigValue ,
}
/* No side effect */
