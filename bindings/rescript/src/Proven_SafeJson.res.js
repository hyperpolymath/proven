// Generated by ReScript, PLEASE EDIT WITH CARE

import * as Js_dict from "rescript/lib/es6/js_dict.js";
import * as Js_json from "rescript/lib/es6/js_json.js";
import * as Belt_Int from "rescript/lib/es6/belt_Int.js";
import * as Belt_Array from "rescript/lib/es6/belt_Array.js";
import * as Belt_Option from "rescript/lib/es6/belt_Option.js";

function fromJsJson(json) {
  var n = Js_json.classify(json);
  if (typeof n !== "object") {
    switch (n) {
      case "JSONFalse" :
          return {
                  TAG: "Bool",
                  _0: false
                };
      case "JSONTrue" :
          return {
                  TAG: "Bool",
                  _0: true
                };
      case "JSONNull" :
          return "Null";
      
    }
  } else {
    switch (n.TAG) {
      case "JSONString" :
          return {
                  TAG: "String",
                  _0: n._0
                };
      case "JSONNumber" :
          return {
                  TAG: "Number",
                  _0: n._0
                };
      case "JSONObject" :
          var converted = Js_dict.map((function (v) {
                  return fromJsJson(v);
                }), n._0);
          return {
                  TAG: "Object",
                  _0: converted
                };
      case "JSONArray" :
          return {
                  TAG: "Array",
                  _0: Belt_Array.map(n._0, fromJsJson)
                };
      
    }
  }
}

function parse(jsonString) {
  try {
    var parsed = JSON.parse(jsonString);
    return fromJsJson(parsed);
  }
  catch (exn){
    return ;
  }
}

function toJsJson(value) {
  if (typeof value !== "object") {
    return null;
  }
  switch (value.TAG) {
    case "Array" :
        return Belt_Array.map(value._0, toJsJson);
    case "Object" :
        return Js_dict.map((function (v) {
                      return toJsJson(v);
                    }), value._0);
    default:
      return value._0;
  }
}

function stringify(value) {
  return JSON.stringify(toJsJson(value));
}

function stringifyPretty(value, indent) {
  return JSON.stringify(toJsJson(value), null, indent);
}

function asString(value) {
  if (typeof value !== "object" || value.TAG !== "String") {
    return ;
  } else {
    return value._0;
  }
}

function asNumber(value) {
  if (typeof value !== "object" || value.TAG !== "Number") {
    return ;
  } else {
    return value._0;
  }
}

function asBool(value) {
  if (typeof value !== "object" || value.TAG !== "Bool") {
    return ;
  } else {
    return value._0;
  }
}

function asArray(value) {
  if (typeof value !== "object" || value.TAG !== "Array") {
    return ;
  } else {
    return value._0;
  }
}

function asObject(value) {
  if (typeof value !== "object" || value.TAG !== "Object") {
    return ;
  } else {
    return value._0;
  }
}

function isNull(value) {
  if (typeof value !== "object") {
    return true;
  } else {
    return false;
  }
}

function getPath(value, path) {
  var parts = path.split(".");
  return Belt_Array.reduce(parts, value, (function (acc, key) {
                if (acc === undefined) {
                  return ;
                }
                if (typeof acc !== "object") {
                  return ;
                }
                switch (acc.TAG) {
                  case "Array" :
                      var idx = Belt_Int.fromString(key);
                      if (idx !== undefined) {
                        return Belt_Array.get(acc._0, idx);
                      } else {
                        return ;
                      }
                  case "Object" :
                      return Js_dict.get(acc._0, key);
                  default:
                    return ;
                }
              }));
}

function setPath(value, path, newValue) {
  var parts = path.split(".");
  var setHelper = function (current, pathParts, idx) {
    if (idx >= pathParts.length) {
      return newValue;
    }
    var key = pathParts[idx];
    if (typeof current !== "object") {
      return ;
    }
    if (current.TAG !== "Object") {
      return ;
    }
    var obj = current._0;
    var existing = Belt_Option.getWithDefault(Js_dict.get(obj, key), "Null");
    var updated = setHelper(existing, pathParts, idx + 1 | 0);
    if (updated === undefined) {
      return ;
    }
    var newObj = Js_dict.fromArray(Js_dict.entries(obj));
    newObj[key] = updated;
    return {
            TAG: "Object",
            _0: newObj
          };
  };
  return setHelper(value, parts, 0);
}

function merge(a, b) {
  if (typeof a !== "object") {
    return ;
  }
  if (a.TAG !== "Object") {
    return ;
  }
  if (typeof b !== "object") {
    return ;
  }
  if (b.TAG !== "Object") {
    return ;
  }
  var merged = Js_dict.fromArray(Js_dict.entries(a._0));
  Belt_Array.forEach(Js_dict.entries(b._0), (function (param) {
          merged[param[0]] = param[1];
        }));
  return {
          TAG: "Object",
          _0: merged
        };
}

function deepMerge(a, b) {
  if (typeof a !== "object") {
    return b;
  }
  if (a.TAG !== "Object") {
    return b;
  }
  if (typeof b !== "object") {
    return b;
  }
  if (b.TAG !== "Object") {
    return b;
  }
  var merged = Js_dict.fromArray(Js_dict.entries(a._0));
  Belt_Array.forEach(Js_dict.entries(b._0), (function (param) {
          var v = param[1];
          var k = param[0];
          var existing = Js_dict.get(merged, k);
          var newVal = existing !== undefined ? deepMerge(existing, v) : v;
          merged[k] = newVal;
        }));
  return {
          TAG: "Object",
          _0: merged
        };
}

export {
  fromJsJson ,
  parse ,
  toJsJson ,
  stringify ,
  stringifyPretty ,
  asString ,
  asNumber ,
  asBool ,
  asArray ,
  asObject ,
  isNull ,
  getPath ,
  setPath ,
  merge ,
  deepMerge ,
}
/* No side effect */
