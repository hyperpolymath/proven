%% SPDX-License-Identifier: PMPL-1.0-or-later
%% Copyright (c) 2026 Jonathan D.A. Jewell (hyperpolymath) <jonathan.jewell@open.ac.uk>
%%
%% Proven - Rebar3 Configuration (NIF-based FFI to libproven)

{erl_opts, [debug_info, warnings_as_errors]}.

{deps, []}.

{project_plugins, [rebar3_hex, rebar3_ex_doc, pc]}.

{provider_hooks, [
    {pre, [
        {compile, {pc, compile}},
        {clean, {pc, clean}}
    ]}
]}.

{port_specs, [
    {"priv/proven_nif.so", ["c_src/proven_nif.c"]}
]}.

{port_env, [
    {"CFLAGS", "$CFLAGS -I../../bindings/c/include -std=c11 -Wall -Wextra -fPIC"},
    {"LDFLAGS", "$LDFLAGS -lproven -L../../build/lib -L/usr/local/lib -Wl,-rpath,$ORIGIN/../../build/lib"}
]}.

{hex, [{doc, ex_doc}]}.

{ex_doc, [
    {source_url, <<"https://github.com/hyperpolymath/proven">>},
    {extras, [<<"README.md">>]},
    {main, <<"readme">>}
]}.

{dialyzer, [
    {warnings, [unknown]},
    {plt_apps, all_deps}
]}.

{xref_checks, [undefined_function_calls, undefined_functions,
               locals_not_used, deprecated_function_calls,
               deprecated_functions]}.

{profiles, [
    {test, [
        {deps, []},
        {erl_opts, [debug_info]}
    ]}
]}.
